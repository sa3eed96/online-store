(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{111:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(30);var c=a(36);function r(e){return function(e){if(Array.isArray(e))return Object(n.a)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(c.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},150:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a(0),r=a.n(c),l=a(14),u=a(3),o=a.n(u),i=a(22),s=a(5),m=a(4),d=a.n(m),b=a(23),p=a(111),f=a(1),h=function(e){var t=Object(c.useState)(e.myRate),a=Object(n.a)(t,2),l=a[0],u=a[1],m=Object(c.useState)(null),h=Object(n.a)(m,2),E=h[0],v=h[1],k=Object(c.useState)([r.a.createElement(f.b,null),r.a.createElement(f.b,null),r.a.createElement(f.b,null),r.a.createElement(f.b,null),r.a.createElement(f.b,null)]),j=Object(n.a)(k,2),O=j[0],R=j[1];Object(c.useEffect)((function(){for(var e=Object(p.a)(O),t=0;t<5;t++)t<l.checkedRate+1?e[t]=r.a.createElement(f.d,null):e[t]=r.a.createElement(f.b,null);R(e)}),[]);var y=function(){var t=Object(s.a)(o.a.mark((function t(a){var n,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a.preventDefault(),n=null,!("id"in l)){t.next=9;break}return t.next=6,d.a.put("/api/product/".concat(e.productId,"/userrate/").concat(l.id),{rateArray:e.rate,rate:l.checkedRate,comment:l.comment});case 6:n=t.sent,t.next=12;break;case 9:return t.next=11,d.a.post("/api/product/".concat(e.productId,"/userrate"),{rateArray:e.rate,rate:l.checkedRate,comment:l.comment});case 11:n=t.sent;case 12:c=n.data,e.updateRate(Object(i.a)({},c.userRate,{checkedRate:c.userRate.rate})),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),v(t.t0.response.data);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e){return t.apply(this,arguments)}}(),w=function(e,t){t.preventDefault(),u(Object(i.a)({},l,{checkedRate:e-1}));for(var a=Object(p.a)(O),n=0;n<5;n++)a[n]=n<e?r.a.createElement(f.d,null):r.a.createElement(f.b,null);R(a)},g=function(e){u(Object(i.a)({},l,Object(b.a)({},e.target.name,e.target.value)))};return r.a.createElement("div",{className:"mb-4"},r.a.createElement("form",{onSubmit:y},r.a.createElement("label",{className:"text-warning clickable",onClick:function(e){return w(1,e)},htmlFor:"r1"},O[0]),r.a.createElement("input",{className:"d-none",type:"radio",name:"checkedRate",value:"0",label:"1",id:"r1",checked:"0"===l.checkedRate,onChange:g}),r.a.createElement("label",{className:"text-warning clickable",onClick:function(e){return w(2,e)},htmlFor:"r2"},O[1]),r.a.createElement("input",{className:"d-none",type:"radio",name:"checkedRate",value:"1",label:"2",id:"r2",checked:"1"===l.checkedRate,onChange:g}),r.a.createElement("label",{className:"text-warning clickable",onClick:function(e){return w(3,e)},htmlFor:"r3"},O[2]),r.a.createElement("input",{className:"d-none",type:"radio",name:"checkedRate",value:"2",label:"3",id:"r3",checked:"2"===l.checkedRate,onChange:g}),r.a.createElement("label",{className:"text-warning clickable",onClick:function(e){return w(4,e)},htmlFor:"r4"},O[3]),r.a.createElement("input",{className:"d-none",type:"radio",name:"checkedRate",value:"3",label:"4",id:"r4",checked:"3"===l.checkedRate,onChange:g}),r.a.createElement("label",{className:"text-warning clickable",onClick:function(e){return w(5,e)},htmlFor:"r5"},O[4]),r.a.createElement("input",{className:"d-none",type:"radio",name:"checkedRate",value:"4",label:"5",id:"r5",checked:"4"===l.checkedRate,onChange:g}),r.a.createElement("textarea",{className:"form-control w-50",name:"comment",placeholder:"optional rate review",value:l.comment,onChange:g}),r.a.createElement("button",{className:"btn btn-success mt-1"},"rate"),"id"in l&&r.a.createElement("button",{onClick:e.edit,className:"btn btn-secondary ml-1 mt-1"},"cancel")),E&&r.a.createElement("p",{className:"text-danger"},r.a.createElement("small",null,E)))},E=a(24),v=function(e){var t=Object(c.useState)(null),a=Object(n.a)(t,2),l=a[0],u=a[1];return Object(c.useEffect)((function(){var t=[0,0,0,0,0];t[e.myRate.checkedRate]+=1,u(r.a.createElement(E.a,{rate:t}))}),[e.myRate.checkedRate]),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("b",null,l),r.a.createElement("br",null),r.a.createElement("h6",null,e.myRate.comment)),r.a.createElement("button",{className:"btn btn-secondary",onClick:e.edit},"Edit"),r.a.createElement("hr",null))},k=a(8),j=a(17),O=function(e){var t=Object(c.useState)({comment:"",checkedRate:"4"}),a=Object(n.a)(t,2),l=a[0],u=a[1],m=Object(c.useState)("edit"),b=Object(n.a)(m,2),p=b[0],f=b[1],E=Object(c.useState)(!0),O=Object(n.a)(E,2),R=O[0],y=O[1];Object(c.useEffect)((function(){(function(){var t=Object(s.a)(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.get("/api/product/".concat(e.productId,"/userrate/myrate"));case 2:a=t.sent,n=a.data,console.log(n),n.myRate&&(u(Object(i.a)({},n.myRate,{checkedRate:n.myRate.rate})),f("view")),y(!1);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]);var w=function(){f("view"===p?"edit":"view")};return r.a.createElement(k.a,{loading:R},"edit"===p&&r.a.createElement(h,{myRate:l,edit:w,updateRate:function(e){j.a.dispatch("showNotification",{body:"Rate Submitted",background:"bg-success",header:"Success"}),u(e),f("view")},productId:e.productId,rate:e.rate}),"view"===p&&r.a.createElement(v,{myRate:l,edit:w}))},R=a(37),y=function(e){var t=Object(c.useContext)(l.a),a=Object(c.useState)([]),u=Object(n.a)(a,2),i=u[0],m=u[1],b=Object(c.useState)(1),p=Object(n.a)(b,2),f=p[0],h=p[1],v=Object(c.useState)(0),k=Object(n.a)(v,2),j=k[0],O=k[1],y=Object(c.useState)(""),w=Object(n.a)(y,2),g=w[0],x=w[1];Object(c.useEffect)((function(){(function(){var t=Object(s.a)(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,x(""),t.next=4,d.a.get("/api/product/".concat(e.productId,"/userrate?page=").concat(f));case 4:a=t.sent,n=a.data,m(n.rates),O(n.count),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),x("error fetching reviews");case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}})()()}),[f]);return r.a.createElement("div",null,g&&r.a.createElement("p",{className:"text-danger"},r.a.createElement("small",null,g)),r.a.createElement("h6",null,i.length," total reviews"),i.map((function(e){return r.a.createElement("div",{className:"border border-dark rounded-right col-8 p-2 mb-2",key:e.id},e.comment&&(!t.state.user||e.PurchaseDetails[0].Purchase.User.id!==t.state.user.id)&&r.a.createElement("div",null,r.a.createElement("i",null,e.PurchaseDetails[0].Purchase.User.fullName)," | ",r.a.createElement("b",null,(a=e.rate,(n=[0,0,0,0,0])[a]+=1,r.a.createElement(E.a,{rate:n}))),r.a.createElement("br",null),r.a.createElement("p",null,e.comment)));var a,n})),r.a.createElement("br",null),j>0&&r.a.createElement(R.a,{page:f,count:j,updatePage:function(e){h(e)},perPage:5}))};t.default=function(e){var t=Object(c.useContext)(l.a),a=Object(c.useState)(e.rate),u=Object(n.a)(a,2),o=u[0],i=u[1];return r.a.createElement("div",null,r.a.createElement("h3",null,"Product Reviews"),t.state.isAuthenticated&&r.a.createElement(O,{productId:e.productId,updateRate:function(e){i(e)},rate:o}),r.a.createElement(y,{productId:e.productId}))}}}]);
//# sourceMappingURL=5.bundle.js.map